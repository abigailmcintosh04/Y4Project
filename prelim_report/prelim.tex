% !TeX program = latexmk
% !TeX outputDirectory = build
\documentclass[12pt]{article}
\usepackage{graphicx}
\usepackage[a4paper, margin=2cm]{geometry}
\usepackage{hyperref}
\usepackage{subcaption}

\begin{document}

\begin{titlepage}
    \begin{center}
        \vspace*{1cm}
        \Huge
        \textbf{Exploring Heavy Quark Fragmentation with Machine Learning at ATLAS}
        
        \vspace{0.5cm}
        \LARGE
        Preliminary Report
        
        \vspace{1.5cm}
        \large
        \textbf{Author: } Abigail McIntosh \\
        \textbf{Project Partner:} Sinead Leckey \\
        \textbf{Supervisors:} Dr Andrew Chisholm, Dr Eleni Skorda \\

        \vspace{1.0cm}
        \textbf{Abstract}

        \vspace{0.2cm}
        \begin{minipage}{0.9\textwidth}
            \small
            [Abstract Placeholder] Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.
        \end{minipage}
        \vfill            

            
        \Large
        School of Physics and Astronomy\\
        University of Birmingham\\
        December 2025\\
    \end{center}
\end{titlepage}

\pagenumbering{roman}
\tableofcontents

\pagebreak
\pagenumbering{arabic}


\section{Introduction}

\subsection{Perturbative and Non-Perturbative QCD}
Quantum Chromodynamics (QCD) is the quantum theory that describes the strong interaction between quarks, that is mediated by gluons. QCD is non-Abelian gauge theory, which leads to gluons carrying the colour charge. This also means that gluons are self-coupling. This self-coupling leads to the two ranges of QCD: asymptotic freedom and confinement. Under asymptotic freedom at high energies, the strong coupling constant $\alpha_s \ll 1$, meaning perturbative calculations (pQCD) can be used. Under confinement at low energies, $\alpha_s \sim 1$, meaning a non-perturbative approach is necessary. 

For pp collisions at the LHC, the hard scattering process occurs at high energies, meaning pQCD can be used to describe it. However, the fragmentation occurs at low energies, meaning pQCD cannot be used to describe it, and are instead described by phenomenological models. The two approaches required to describe the collisions are connected by the factorisation theorem, which states that the cross section can be split into three parts: the parton distribution functions (PDFs), the hard scatter, and the fragmentation functions.

\subsection{Fragmentation and Universality}
Fragmentation is the non-perturbative process by which coloured partons are confined into colourless hadrons. The fragmentation function $D^h_i(x, \mu^2) (i=q,\bar{q},g)$ describes the probability density that a certain outgoing parton $i$ produces a hadron $h$, where $x$ is the fraction of the parton's momentum transferred to the hadron and $\mu$ is the factorisation scale \cite{pdg2018}.

Historically, it has been assumed fragmentation functions are universal, meaning they are independent of the hard scattering process. This means fragmentation functions should be the same for pp collisions as for e$^+$e$^-$ collisions. However, recent measurements of charm quark hadronisation in the ALICE collaboration found a larger fraction hadronising into baryons in pp collisions compared to e$^+$e$^-$ collisions \cite{alice2023charm}, suggesting fragmentation may not be universal and instead dependent on the environment.

\section{Project Aims and Motivations}
The aim of this project is to explore heavy quark fragmentation using a machine learning (ML) approach, focusing on charm quarks. A machine learning model will be created to distinguish between jets containing different charmed hadrons, specifically $D^0$, $D^+$, $D_s^+$ mesons, $\Lambda_c^+$ baryons, and their corresponding antiparticles. Traditional methods using reconstruction have low efficiency due to the need to identify all the charm hadron's decay products, so a machine learning approach could improve this. The model will be trained on Monte Carlo (MC) simulated events, and then be applied to real data from the ATLAS detector at the LHC. By comparing the ratio of charm hadrons identified in the real data to the MC simulated data, the universality of the charm quark fragmentation can be investigated.

As mentioned earlier, phenomenological models are needed to describe fragmentation, therefore these models need their parameters tuned to match experimental data. By improving the efficiency of identifying charm hadrons, the accuracy of Monte Carlo generators such as PYTHIA can be improved.

For a Higgs mass of 125 GeV, the predicted branching fraction of $H \rightarrow b \bar{b}$ is 58\% \cite{higgs} and for $H \rightarrow c \bar{c}$ it is 3\%. However, the $H \rightarrow c \bar{c}$ decay is yet to be detected. In order to detect this decay, charm jets need to be tagged with a high accuracy. The jet taggers are typically trained on MC simulated data, which typically assume universality. Hence, if fragmentation is not universal in the ATLAS data, the jet tagging algorithms are not being trained correctly, and so would perform worse when applied to real data. By developing an ML model to identify charm hadrons, a comparison between MC and ATLAS data can be made, testing the assumption of universality.



\section{Event Generation}
To train the machine learning model, Monte Carlo (MC) simulated events are used. The events are generated using PYTHIA 8 \cite{pythia8}, generating pp collisions at $\sqrt{s} = 13$ TeV. To ensure only charm events are generated, the enabled hard QCD processes are qq $\rightarrow$ c\={c} and gg $\rightarrow$ c\={c}. A minimum transverse momentum of 20 GeV is set for the hard scatter to ensure the events are jet-like in nature. Initial and final state radiation and hadronisation are enabled, while multiple parton interactions are disabled. 

For each final state particle in a PYTHIA event, a FastJet \cite{fastjet} PseudoJet object is created. The pseudojets are then clustered using the anti-$k_t$ algorithm, with a radius parameter of R = 0.4, to form jets.The jets are then matched to the charm quarks via a $\Delta R$ matching, where $\Delta R = \sqrt{(\Delta \eta)^2 + (\Delta \phi)^2}$, with a maximum $\Delta R$ of 0.4. 

\subsection{Lund String Model}
PYTHIA uses the Lund string model to simulate hadronisation. In this model, when a quark-antiquark pair is separated, the gluon field lines collapse into a flux tube, or string. The potential energy stored in the string increases linearly with the separation distance, $V(r) = \kappa r$, where $\kappa$ is the string tension, approximately 1 GeV/fm. When it becomes energetically favourable, the string will break, creating a new quark-antiquark pair. The probability of creating a pair of mass $\mu$ with transverse momentum $p_{\perp}$ is given by:

\begin{equation}
    P(m) \propto \exp\left(-\frac{\pi (\mu^2 + p_{\perp}^2)}{\kappa}\right),
\end{equation}

meaning the production of heavier quarks (charm and bottom) is suppressed \cite{lundmodel}. Therefore, the production of $\Lambda_c$ baryons (quark content udc) is suppressed compared to D mesons (containing one charm quark and another light quark). The mass of a ud-\={u}\={d} diquark is much larger than a u\={u} or d\={d} pair, with the suppression of diquark production to quark production in PYTHIA defined as 0.081 \cite{pythia8}, where universality is assumed.

\subsection{Event Structure}

\section{Machine Learning}
To explore the fragmentation of charm quarks, a machine learning model will be developed to classify jets based on the charmed hadron(s) they contain. The current approach of reconstruction requires identifying all the decay products of the charmed hadron, leading to low reconstruction efficiency. To solve this, a machine learning model will be used to classify jets based on their overall properties, increasing efficiency. This model will be trained with the Monte Carlo simulated events described in Section 2.

\subsection{Input Features}
As the charmed hadrons have different lifetimes, masses, and decay properties (as shown in Table \ref{tab:charm_props}), the jets containing them are expected to have slightly different properties. Distinguishing variables can be generated from the energy-momentum four vectors of the jet constituents. It is necessary to limit the distinguishing variables to ones that could be calculated from the data available from the ATLAS detector so that when the machine learning algorithm is applied onto real data, the distinguishing variables can still be calculated.

\begin{table}[h]
    \centering
    \begin{tabular}{|c|c|c|c|}
        \hline
        Hadron & Quark Content & Mass (MeV) & Lifetime (fs) \\
        \hline 
        $D^0$ & $c\bar{u}$ & $1864.84 \pm 0.05$ & $410.3 \pm 1.0$ \\
        $D^+$ & $c\bar{d}$ & $1869.5 \pm 0.4$ & $1033 \pm 5$ \\
        $D_s^+$ & $c\bar{s}$ & $1969.0 \pm 1.4$ & $501.2 \pm 2.2$ \\
        $\Lambda_c^+$ & $udc$ & $2286.46 \pm 0.14$ & $202.6 \pm 1.0$ \\
        \hline
    \end{tabular}
    \caption{Properties of charmed hadrons being used \cite{pdg}.}
    \label{tab:charm_props}
\end{table}

Two main distinguishing variables that have been identified so far are $L_{xy}$, which is the transverse decay length of the charmed hadron, and $d_0$, which is the transverse impact parameter of the charmed hadron. They are defined as follows:
\begin{equation}
    L_{xy} = \sqrt{(x_{SV}-x_{PV})^2 + (y_{SV}-y_{PV})^2},
\end{equation}
where $(x_{SV}$ and $y_{SV})$ are the x and y coordinates of the secondary vertex (SV) of the charmed hadron decay, and $(x_{PV}$ and $y_{PV})$ are the x and y coordinates of the primary vertex (PV) of the initial hard scattering;
\begin{equation}
    d_0 = \frac{1}{p_T} (x_{PV} p_y - y_{PV} p_x),
\end{equation}
where $p_T$ is the transverse momentum of the charmed hadron, $p_x$ and $p_y$ are the x and y components of the momentum of the charmed hadron, and $(x_{PV}, y_{PV})$ are as defined above.

\begin{figure}
    \centering
    \includegraphics[width=0.6\textwidth]{images/vertices.png}
    \caption{Diagram showing a typical decay of a charmed hadron at ATLAS, showing the primary and secondary vertices, as well as $L_{xy}$ and $d_0$ \cite{atlas2021triggers}.}
    \label{fig:vertices}
\end{figure}

As can be seen in \ref{fig:vertices}, $L_{xy}$ and $d_0$ are directly related to the displacement of the charmed hadron from the PV. For $L_{xy}$, as this is the transverse distance between the PV and SV, this is directly related to the hadron's lifetime. For $d_0$, as this is the distance of closest approach of the track to the PV, tracks from longer lived hadtons will on average have a larger $d_0$.

As can be seen in Table \ref{tab:charm_props}, the lifetimes of the $D_s^+$ and the $D_0$ mesons are similar, within 100fs of each other. This means that purely relying on lifetime-related variables such as $L_{xy}$ and $d_0$ may not be sufficient to distinguish between jets containing those mesons. As a result, distinguishing variables related to the mass will also be investigated. 

\begin{figure}
    \centering
    \begin{subfigure}{0.48\textwidth}
        \centering
        \includegraphics[width=\linewidth]{images/lxy.png}
        \caption{Distribution of $L_{xy}$}
        \label{fig:lxy}
    \end{subfigure}\hfill
    \begin{subfigure}{0.48\textwidth}
        \centering
        \includegraphics[width=\linewidth]{images/d0_mean.png}
        \caption{Distribution of mean $d_0$}
        \label{fig:d0}
    \end{subfigure}
    \caption{Distributions of distinguishing variables for charmed hadrons. A sample of 1 million charm hadron events was generated with a minimum $p_T$ of 20 GeV.}
    \label{fig:charm_vars}
\end{figure}

\subsection{Impact Parameter Threshold for Mass-based Variables}

Mass-based variables require a more nuanced approach. The current approach for calculating lifetime-related summary variables is to take averages across all jet constituents, not just those from the charmed hadron, as despite having the truth information to know which constituents come from the charmed hadron in the event generation, this information will not be available when using real data. The differing values of the lifetime-related variables will affect the averages across the whole jet, meaning this approach is valid. However, for mass-based variables, as the hadron mass is only a small fraction of the total jet mass, the effect on the average could be too small to detect. Hence, an alternative approach was taken, where tracks were filtered based on their $d_0$. Summary variables were calculated for tracks with a $d_0$ above a specific threshold, as those tracks are more likely to have originated from the charmed hadron. 

To find this threshold, a balance must be struck between signal efficiency, which is the fraction of the tracks correctly identified as coming from the charm hadron, and background rejection, which is the fraction of non-charm hadron tracks being identified as such. A larger signal efficiency leads to a lower background rejection rate, and vice versa, hence the need to strike a balance. To find this balance, signal efficiency and background rejection are plotted on the same axes for different $d_0$ thresholds, as shown in Figure \ref{fig:eff_rej}. The threshold was chosen to be where the two curves intersect, at 0.014mm. 

\begin{figure}
    \centering
    \includegraphics[width=0.6\textwidth]{images/sig_eff.png}
    \caption{Signal efficiency and background rejection as a function of $d_0$ threshold.}
    \label{fig:eff_rej}
\end{figure}


\section{Future Plans}

\subsection{Machine Learning Model Development}
The development of the machine learning model will be split into two paths. The author will carry on with a simpler Feed Forward Neural Network (FFNN) approach, continuing the current approach of using summary variables and further developing and fine-tuning those summary variables. In parallel, the project partner will develop a more advanced neural network architecture that can take in the four vectors of the constituents directly, as opposed to using summary variables.

\subsection{Event Generation Development}
The approach of using $d_0$ thresholds to identify tracks originating from the charmed hadron will be further developed for mass-based variables, and will be applied to lifetime-based variables as well. The effectiveness of using this approach will be evaluated by comparing the performance of the machine learning model for the two different approaches. In addition, the ATLAS detector will be simulated, possibly using DELPHES. This will allow detector effects, such as efficiency, resolution (via a Gaussian smear) and rejection of high pseudorapidity events, to be included in the simulation. This will improve the realism of the event generation, leading to more accurate training of the machine learning model.

\bibliographystyle{plain}
\bibliography{references}

\end{document}